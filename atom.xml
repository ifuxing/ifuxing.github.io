<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ifuxing</title>
  
  <subtitle>福星小栈</subtitle>
  <link href="https://ifuxing.cool/atom.xml" rel="self"/>
  
  <link href="https://ifuxing.cool/"/>
  <updated>2020-12-09T13:54:57.337Z</updated>
  <id>https://ifuxing.cool/</id>
  
  <author>
    <name>Felstar</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>关于Dubbo隐式传参的整理</title>
    <link href="https://ifuxing.cool/2020/05/07/Dubbo%E9%9A%90%E5%BC%8F%E4%BC%A0%E5%8F%82/"/>
    <id>https://ifuxing.cool/2020/05/07/Dubbo%E9%9A%90%E5%BC%8F%E4%BC%A0%E5%8F%82/</id>
    <published>2020-05-07T14:31:14.000Z</published>
    <updated>2020-12-09T13:54:57.337Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>记录一下，隐式传参所遇见的坑！！！在Dubbo使用过程中，有一些通用参数如果显式的在接口参数中传递，使用起来会有一些不方便。比如：经常使用的session中存放的用户信息，如果都放入参数中传递，这样会耦合到业务逻辑中了，这时隐式传参就是一种比较好的处理方式了。</p></blockquote><a id="more"></a><h2 id="1-介绍"><a href="#1-介绍" class="headerlink" title="1. 介绍"></a>1. 介绍</h2><h3 id="1-1-Dubbo隐式传参"><a href="#1-1-Dubbo隐式传参" class="headerlink" title="1.1 Dubbo隐式传参"></a>1.1 Dubbo隐式传参</h3><p>Dubbo的隐式传参是通过RpcContext上下文对象进行实现的。而RpcContext是一个ThreadLocal的临时状态记录器，当接收到RPC请求，或发起RPC请求时，RpcContext的状态都会变化。比如A调用B，RpcContext记录的是A调用B的信息。B再调用C，RpcContext的记录则更新为是B调用C的信息。</p><h3 id="1-2-ThreadLocal"><a href="#1-2-ThreadLocal" class="headerlink" title="1.2 ThreadLocal"></a>1.2 ThreadLocal</h3><p>Threadlocal是一个线程内部的存储类，提供了线程内存储变量的能力,可以在指定线程内存储数据，数据存储以后，只有指定线程可以得到存储数据。这些变量不同之处在于每一个线程读取的变量是对应的互相独立的。</p><p>其内部维护了一个ThreadLocalMap，该Map用于存储每一个线程的变量副本。并且key为线程对象，value为对应线程的变量副本</p><h2 id="2-使用"><a href="#2-使用" class="headerlink" title="2.使用"></a>2.使用</h2><p>要使用Dubbo隐式传参，只需要两个api即可</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//向RpcContext存储内容</span></span><br><span class="line">RpcContext.getContext().setAttachment(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;value&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//从RpcContext获取内容</span></span><br><span class="line">String value= RpcContext.getContext().getAttachment(<span class="string">&quot;key&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="3-问题总结"><a href="#3-问题总结" class="headerlink" title="3.问题总结"></a>3.问题总结</h2><h4 id="3-1-Dubbo多重调用导致隐式传参丢失"><a href="#3-1-Dubbo多重调用导致隐式传参丢失" class="headerlink" title="3.1 Dubbo多重调用导致隐式传参丢失"></a>3.1 Dubbo多重调用导致隐式传参丢失</h4><p>隐式参数只在当次调用中有效，下一次调用时必须重新塞入参数。这是因为ConsumerContextClusterInterceptor对象的after方法在收到响应后，会执行<code>RpcContext.removeContext();</code>。</p><p>服务端收到请求后，在过滤器ContextFilter中，创建服务端的RpcContext对象，并将消费端传递的attachments属性值添加到服务端的RpcContext对象中。</p><p>我们在使用RpcContext时，必须使用RpcContext.getContext()获取RpcContext对象，不能使用new RpcContext()的方式创建。</p><h4 id="3-2-解决方法"><a href="#3-2-解决方法" class="headerlink" title="3.2 解决方法"></a>3.2 解决方法</h4><p>以下根据我们项目中大佬搭建的环境总结的方法</p><p><strong>主要步骤</strong></p><ol><li><p>创建一个自定义上下文对象的类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.LinkedHashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TenantContext</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> ThreadLocal&lt;Map&lt;String,Object&gt;&gt; threadLocal = <span class="keyword">new</span> ThreadLocal&lt;Map&lt;String, Object&gt;&gt;()&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> Map&lt;String, Object&gt; <span class="title">initialValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> LinkedHashMap&lt;String, Object&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addAttachment</span><span class="params">(String key, Object value)</span></span>&#123;</span><br><span class="line">        threadLocal.get().put(key,value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addAttachments</span><span class="params">(Map&lt;String, Object&gt; map)</span></span>&#123;</span><br><span class="line">        threadLocal.get().putAll(map);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title">getAttachments</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> threadLocal.get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span>  <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span>&#123;</span><br><span class="line">        threadLocal.remove();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getShopId</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> String.valueOf(threadLocal.get().get(<span class="string">&quot;shopId&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ol start="2"><li><p>创建一个Dubbo的Filter类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DubboConsumerContextFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">invoke</span><span class="params">(Invoker&lt;?&gt; invoker, Invocation invocation)</span> <span class="keyword">throws</span> RpcException </span>&#123;</span><br><span class="line">                 RpcContext.getContext().setAttachment(<span class="string">&quot;shopId&quot;</span>, TenantContext.getShopId());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> invoker.invoke(invocation);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>==注意==</p><p>还需要将filter配置到META-INF中，路径名字不能错，/src/main/:/META-INF/dubbo/下新建文件：com.alibaba.dubbo.rpc.Filter，<strong>记得将这个配置导入到Spring或者yml的配置文件中</strong><br>文件内容如下：</p><blockquote><p>dubboConsumerContextFilter=com.xxx.DubboConsumerContextFilter</p></blockquote></li></ol><h3 id="4-问题补充"><a href="#4-问题补充" class="headerlink" title="4. 问题补充"></a>4. 问题补充</h3><p>以上是消费者调用的时候出现的隐式传参问题，我在项目中还遇见了另外的隐式传参问题，具体原因我觉得应该是类似。</p><p>我将这个问题出现和解决方法做了一个流程图，用来总结，这是拿我遇见的问题举的例子，其中</p><p><strong>WebHandlerInterceptor</strong>：Web拦截器，登录解析JWT令牌用的</p><p><strong>TenantContext</strong>：自定义的上下文对象</p><p><strong>DubboConsumerContextFilter</strong>：Dubbo过滤器</p><p><strong>MybatisPlusTenantContext</strong>：多租户的配置</p><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201209181018.png" alt="image-20201209181018578"></p><p><strong>总的而言，这个使用于服务之间调用的时候</strong></p><ol><li><p>在业务方法执行前，手动向<code>TenantContext</code>对象中添加租户信息，你们需要的改成需要隐式传参的信息就可以</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TenantContext.addAttachment(<span class="string">&quot;shopId&quot;</span>,RpcContext.getContext().getAttachment(<span class="string">&quot;shopId&quot;</span>));</span><br><span class="line">TenantContext.addAttachment(<span class="string">&quot;storeId&quot;</span>,RpcContext.getContext().getAttachment(<span class="string">&quot;storeId&quot;</span>));</span><br></pre></td></tr></table></figure></li><li><p>在多租户配置中，在需要接受信息的方法调用前，添加一个获取信息的方法。每一个需要接受的信息都要用这个方法校验一下。如下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> String <span class="title">getShopId</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="comment">//远程获取</span></span><br><span class="line">      String shopId= RpcContext.getContext().getXXXAttachment(<span class="string">&quot;shopId&quot;</span>);</span><br><span class="line">      <span class="comment">//如果远程获取为空XXX</span></span><br><span class="line">      <span class="keyword">if</span>(isEmpty(shopId))&#123;</span><br><span class="line">          shopId = TenantContext.getShopId();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> shopId;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    
    <summary type="html">&lt;blockquote class=&quot;blockquote-center&quot;&gt;
&lt;p&gt;记录一下，隐式传参所遇见的坑！！！在Dubbo使用过程中，有一些通用参数如果显式的在接口参数中传递，使用起来会有一些不方便。比如：经常使用的session中存放的用户信息，如果都放入参数中传递，这样会耦合到业务逻辑中了，这时隐式传参就是一种比较好的处理方式了。&lt;/p&gt;

&lt;/blockquote&gt;</summary>
    
    
    
    <category term="Java" scheme="https://ifuxing.cool/categories/Java/"/>
    
    
    <category term="Dubbo" scheme="https://ifuxing.cool/tags/Dubbo/"/>
    
  </entry>
  
  <entry>
    <title>关于Dubbo序列化的整理</title>
    <link href="https://ifuxing.cool/2020/03/19/Dubbo%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E6%95%B4%E7%90%86/"/>
    <id>https://ifuxing.cool/2020/03/19/Dubbo%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E6%95%B4%E7%90%86/</id>
    <published>2020-03-19T13:36:14.000Z</published>
    <updated>2020-11-30T03:44:21.117Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>最近遇见了一个问题，在Dubbo框架下使用MyBatis-Plus，如果这时Controller层对Services调用时，有Querywrapper作为参数就会报错，查了很多资料，都解决不了，后面发现是因为dubbo无法传输复杂对象，无法解决，必须写在service层中，顺便一起总结一下dubbo序列化问题</p></blockquote><a id="more"></a><h2 id="一-发现错误"><a href="#一-发现错误" class="headerlink" title="一. 发现错误"></a>一. 发现错误</h2><p>在 Dubbo的Consumer的Controller中执行以Querywrpper作为参数的代码，就会报错。开始的时候报Hessian序列化的错误，我以为是序列化方式的问题，就改成了Kryo，还是报错，后面去网上各种查各种试都不行，后面把代码放入Service层中之后突然好了。所以我觉得大概率是Dubbo无法序列化特别复杂的对象，所以只要按规范将执行逻辑调用的代码放在Service层即可。</p><h2 id="二-整理Dubbo序列化问题"><a href="#二-整理Dubbo序列化问题" class="headerlink" title="二. 整理Dubbo序列化问题"></a>二. 整理Dubbo序列化问题</h2><h3 id="1-定义抽象接口"><a href="#1-定义抽象接口" class="headerlink" title="1.定义抽象接口"></a>1.定义抽象接口</h3><p>Dubbo框架中的序列化实现的种类有各种各样的,所以为了方便给他们一个统一的规范,于是使用<code>Serialization</code>作为序列化的统一接口,无论任何方案都需要实现该接口</p><h3 id="2-序列化实现"><a href="#2-序列化实现" class="headerlink" title="2.序列化实现"></a>2.序列化实现</h3><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201130110248.png" alt="image-20201130110247858"></p><h4 id="2-1-Kryo"><a href="#2-1-Kryo" class="headerlink" title="2.1 Kryo"></a>2.1 Kryo</h4><ul><li><p><strong>支持的类型</strong></p><ol><li>枚举</li><li>集合、数组</li><li>子类/多态</li><li>循环引用</li><li>内部类</li><li>泛型</li></ol></li><li><p><strong>注意事项</strong></p><ol><li><p><strong>Kryo 不支持 Bean 中增删字段</strong> 。如果使用 Kryo 序列化了一个类，存入了 Redis，对类进行了修改，会导致反序列化的异常。</p></li><li><p>使用反射创建的一些类序列化的支持，如使用 Arrays.asList(); 创建的 List 对象，会引起序列化异常。但 new ArrayList() 创建的 List 对象则不会，</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread <span class="string">&quot;main&quot;</span> com.esotericsoftware.kryo.KryoException: <span class="function">Class cannot be <span class="title">created</span> <span class="params">(missing no-arg constructor)</span>: java.util.Arrays$ArrayList</span></span><br></pre></td></tr></table></figure></li><li><p><strong>不支持包含无参构造器类的反序列化</strong>，尝试反序列化一个不包含无参构造器的类将会得到以下的异常：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread <span class="string">&quot;main&quot;</span> com.esotericsoftware.kryo.KryoException: <span class="function">Class cannot be <span class="title">created</span> <span class="params">(missing no-arg constructor)</span>: moe.cnkirito.Xxx</span></span><br></pre></td></tr></table></figure></li></ol></li><li><p><strong>线程安全</strong></p><p>Kryo 是线程不安全的，意味着每当需要序列化和反序列化时都需要实例化一次，或者借助 ThreadLocal 来维护以保证其线程安全。</p></li></ul><h4 id="2-2-Hessian"><a href="#2-2-Hessian" class="headerlink" title="2.2 Hessian"></a>2.2 Hessian</h4><p>支持跨语言，序列化后字节数适中，API 易用。是国内主流 rpc 框架：dubbo，motan 的默认序列化协议。</p><p><strong>注意事项</strong></p><p>使用 Hessian 序列化包含 BigDecimal 字段的对象时会导致其值一直为 0，不注意这个 bug 会导致很大的问题，具体解决方法，见<a href="https://my.oschina.net/wlmouse/blog/3053308">Hessian不能正确序列化和反序列化BigDecimal的解决</a></p>]]></content>
    
    
    <summary type="html">&lt;blockquote class=&quot;blockquote-center&quot;&gt;
&lt;p&gt;最近遇见了一个问题，在Dubbo框架下使用MyBatis-Plus，如果这时Controller层对Services调用时，有Querywrapper作为参数就会报错，查了很多资料，都解决不了，后面发现是因为dubbo无法传输复杂对象，无法解决，必须写在service层中，顺便一起总结一下dubbo序列化问题&lt;/p&gt;

&lt;/blockquote&gt;</summary>
    
    
    
    <category term="Java" scheme="https://ifuxing.cool/categories/Java/"/>
    
    
    <category term="Dubbo" scheme="https://ifuxing.cool/tags/Dubbo/"/>
    
  </entry>
  
  <entry>
    <title>MyBatis-Plus进阶了解</title>
    <link href="https://ifuxing.cool/2020/02/19/MyBatis-Plus%E8%BF%9B%E9%98%B6%E4%BA%86%E8%A7%A3/"/>
    <id>https://ifuxing.cool/2020/02/19/MyBatis-Plus%E8%BF%9B%E9%98%B6%E4%BA%86%E8%A7%A3/</id>
    <published>2020-02-19T15:14:21.000Z</published>
    <updated>2020-12-09T10:21:30.607Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>MybBtis-Plus提供了AbstractWrapper抽象类，提供了很多SQL语法支持的方法，比如模糊查询，比较，区间，分组查询，排序，判断空，子查询等等，方便我们用面向对象的方式去实现sql语句；AbstractWrapper有两个常用的实现类，分别是QueryWrapper和UpdateWrapper，我们以后就用这两个实现类；</p></blockquote><a id="more"></a><h1 id="一-MybBtis-Plus条件构造器"><a href="#一-MybBtis-Plus条件构造器" class="headerlink" title="一.MybBtis-Plus条件构造器"></a>一.MybBtis-Plus条件构造器</h1><p>这篇主要是讲述MybBtis-Plus的条件构造器,</p><h3 id="1-条件符号对应"><a href="#1-条件符号对应" class="headerlink" title="1. 条件符号对应"></a>1. 条件符号对应</h3><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201116002405.png" alt="image-20201116002404968"></p><h3 id="2-基础比较查询"><a href="#2-基础比较查询" class="headerlink" title="2. 基础比较查询"></a>2. 基础比较查询</h3><h4 id="比较查询"><a href="#比较查询" class="headerlink" title="比较查询"></a>比较查询</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrapper1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//1.创建查询条件构建器</span></span><br><span class="line">        QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        <span class="comment">//2.设置条件</span></span><br><span class="line">        wrapper.eq(<span class="string">&quot;user_name&quot;</span>,<span class="string">&quot;lisi&quot;</span>)<span class="comment">//字段名和对应值</span></span><br><span class="line">                .or().<span class="comment">//表示或</span></span><br><span class="line">                .lt(<span class="string">&quot;age&quot;</span>,<span class="number">23</span>)  <span class="comment">//表示条件</span></span><br><span class="line">                .in(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;李四&quot;</span>,<span class="string">&quot;王五&quot;</span>);       <span class="comment">//字段名和多个中的一个</span></span><br><span class="line">      </span><br><span class="line">        <span class="comment">//select * from tb_user where user_name = ? and age &lt; ? and name in (?,?)</span></span><br><span class="line">        List&lt;User&gt; users = userMapper.selectList(wrapper);</span><br><span class="line">        System.out.println(users);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="3-模糊查询"><a href="#3-模糊查询" class="headerlink" title="3.模糊查询"></a>3.模糊查询</h3><h4 id="3-1-分类"><a href="#3-1-分类" class="headerlink" title="3.1 分类"></a>3.1 分类</h4><table><thead><tr><th>模糊查询</th><th></th></tr></thead><tbody><tr><td>like</td><td>%xxxx%</td></tr><tr><td>notlike</td><td></td></tr><tr><td>likeLeft</td><td>%xxxx</td></tr><tr><td>likeRight</td><td>xxxx%</td></tr></tbody></table><h4 id="3-2-代码实现"><a href="#3-2-代码实现" class="headerlink" title="3.2 代码实现"></a>3.2 代码实现</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrapper3</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//1.创建查询条件构建器</span></span><br><span class="line">        QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        <span class="comment">//2.设置条件</span></span><br><span class="line">        wrapper.likeLeft(<span class="string">&quot;user_name&quot;</span>,<span class="string">&quot;zhang&quot;</span>);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            SELECT id,user_name,password,name,age,email</span></span><br><span class="line"><span class="comment">             from tb_user</span></span><br><span class="line"><span class="comment">             where user_name like ?</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">             %zhang</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        List&lt;User&gt; users = userMapper.selectList(wrapper);</span><br><span class="line">        System.out.println(users);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="4-排序查询"><a href="#4-排序查询" class="headerlink" title="4. 排序查询"></a>4. 排序查询</h3><h4 id="4-1分类"><a href="#4-1分类" class="headerlink" title="4.1分类"></a>4.1分类</h4><table><thead><tr><th>排序方式</th><th></th></tr></thead><tbody><tr><td><strong>orderBy</strong></td><td>自定义排序方式</td></tr><tr><td><strong>orderByDesc</strong></td><td>降序</td></tr><tr><td><strong>orderByAsc</strong></td><td>升序</td></tr></tbody></table><h4 id="4-2-代码实现"><a href="#4-2-代码实现" class="headerlink" title="4.2 代码实现"></a>4.2 代码实现</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrapper4</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//1.创建查询条件构建器</span></span><br><span class="line">        QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        <span class="comment">//2.设置条件</span></span><br><span class="line">        wrapper.eq(<span class="string">&quot;user_name&quot;</span>,<span class="string">&quot;lisi&quot;</span>)</span><br><span class="line">                .or()</span><br><span class="line">                .lt(<span class="string">&quot;age&quot;</span>,<span class="number">23</span>)</span><br><span class="line">                .in(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;李四&quot;</span>,<span class="string">&quot;王五&quot;</span>)</span><br><span class="line">                <span class="comment">//.orderBy(true,true,&quot;age&quot;)    </span></span><br><span class="line">               <span class="comment">//这里的orderBy三个参数，1.是否符合条件，符合则排序2.是否升序3.根据哪个字段排序</span></span><br><span class="line">                .orderByDesc(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            select * from tb_user where user_name = ? or age &lt; ? and name in (?,?) order by age asc</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        List&lt;User&gt; users = userMapper.selectList(wrapper);</span><br><span class="line">        System.out.println(users);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="5-select（指定需要查询的字段）"><a href="#5-select（指定需要查询的字段）" class="headerlink" title="5. select（指定需要查询的字段）"></a>5. select（指定需要查询的字段）</h3> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrapper5</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//1.创建查询条件构建器</span></span><br><span class="line">        QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        <span class="comment">//2.设置条件</span></span><br><span class="line">        wrapper.eq(<span class="string">&quot;user_name&quot;</span>,<span class="string">&quot;lisi&quot;</span>)</span><br><span class="line">                .or()</span><br><span class="line">                .lt(<span class="string">&quot;age&quot;</span>,<span class="number">23</span>)</span><br><span class="line">                .in(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;李四&quot;</span>,<span class="string">&quot;王五&quot;</span>)</span><br><span class="line">                .orderByDesc(<span class="string">&quot;age&quot;</span>)</span><br><span class="line">                .select(<span class="string">&quot;id&quot;</span>,<span class="string">&quot;user_name&quot;</span>);<span class="comment">//这里是指定查询,里面写上需要查询的字段名,用逗号分隔</span></span><br><span class="line">        ;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            select id,user_name from tb_user where user_name = ? or age &lt; ? and name in (?,?) order by age asc</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        List&lt;User&gt; users = userMapper.selectList(wrapper);</span><br><span class="line">        System.out.println(users);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="6-分页加条件查询"><a href="#6-分页加条件查询" class="headerlink" title="6. 分页加条件查询"></a>6. 分页加条件查询</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrapper6</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> current = <span class="number">1</span>;<span class="comment">//当前页码</span></span><br><span class="line">        <span class="keyword">int</span> size = <span class="number">2</span>;<span class="comment">//每页显示条数</span></span><br><span class="line">        <span class="comment">//1. 构建分页对象</span></span><br><span class="line">        Page&lt;User&gt; page = <span class="keyword">new</span> Page&lt;&gt;(current,size);</span><br><span class="line">        <span class="comment">//2. 构建条件对象</span></span><br><span class="line">        QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper();</span><br><span class="line">        wrapper.lt(<span class="string">&quot;age&quot;</span>,<span class="number">23</span>);<span class="comment">//这里表示要根据的条件</span></span><br><span class="line"></span><br><span class="line">        userMapper.selectPage(page,wrapper);</span><br><span class="line"></span><br><span class="line">        List&lt;User&gt; records = page.getRecords();</span><br><span class="line">        <span class="keyword">long</span> total = page.getTotal();</span><br><span class="line">        <span class="keyword">long</span> pages = page.getPages();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="7-LambdaQueryWrapper（消除代码中的硬编码）"><a href="#7-LambdaQueryWrapper（消除代码中的硬编码）" class="headerlink" title="7. LambdaQueryWrapper（消除代码中的硬编码）"></a>7. LambdaQueryWrapper（消除代码中的硬编码）</h3><p> <img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201116012246.png" alt="image-20201116012246567"></p><h3 id="8-删除和修改的条件构造"><a href="#8-删除和修改的条件构造" class="headerlink" title="8. 删除和修改的条件构造"></a>8. 删除和修改的条件构造</h3><h4 id="8-1删除条件"><a href="#8-1删除条件" class="headerlink" title="8.1删除条件"></a>8.1删除条件</h4>   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrapper8</span><span class="params">()</span></span>&#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        wrapper.eq(<span class="string">&quot;user_name&quot;</span>,<span class="string">&quot;bbb&quot;</span>);<span class="comment">//</span></span><br><span class="line">        userMapper.delete(wrapper);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="8-2修改条件"><a href="#8-2修改条件" class="headerlink" title="8.2修改条件"></a>8.2修改条件</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrapper9</span><span class="params">()</span></span>&#123;</span><br><span class="line">        UpdateWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> UpdateWrapper&lt;&gt;();</span><br><span class="line">        <span class="comment">//条件</span></span><br><span class="line">        wrapper.eq(<span class="string">&quot;user_name&quot;</span>,<span class="string">&quot;lisi&quot;</span>)</span><br><span class="line">                .set(<span class="string">&quot;password&quot;</span>,<span class="string">&quot;22222&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//update tb_user set password = ? where user_name = ?</span></span><br><span class="line">        userMapper.update(<span class="keyword">null</span>,wrapper);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrapper10</span><span class="params">()</span></span>&#123;</span><br><span class="line">        UpdateWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> UpdateWrapper&lt;&gt;();</span><br><span class="line">    <span class="comment">//条件</span></span><br><span class="line">        wrapper.eq(<span class="string">&quot;user_name&quot;</span>,<span class="string">&quot;lisi&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//update tb_user set password = ?,age = ? where user_name = ?</span></span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setPassword(<span class="string">&quot;3333&quot;</span>);</span><br><span class="line">        user.setAge(<span class="number">33</span>);</span><br><span class="line">        userMapper.update(user,wrapper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="二-MyBatis-Plus向数据库表格中添加通用字段"><a href="#二-MyBatis-Plus向数据库表格中添加通用字段" class="headerlink" title="二. MyBatis-Plus向数据库表格中添加通用字段"></a>二. MyBatis-Plus向数据库表格中添加通用字段</h1><h3 id="1-实体类中"><a href="#1-实体类中" class="headerlink" title="1. 实体类中"></a>1. 实体类中</h3><p>给需要加入通用字段的属性上加如**@TableField(fill = FieldFill.INSERT_UPDATE)**表示插入，修改和插入时候可以自动填充</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TableField(fill = FieldFill.INSERT_UPDATE)</span></span><br><span class="line"><span class="keyword">private</span> LocalDateTime lastUpdateTime;</span><br></pre></td></tr></table></figure><h3 id="2-创建一个工具类填充属性"><a href="#2-创建一个工具类填充属性" class="headerlink" title="2. 创建一个工具类填充属性"></a>2. 创建一个工具类填充属性</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>：ifuxing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>：2020/2/19/15:18</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>：</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GeneralMetaObjectHandler</span> <span class="keyword">implements</span> <span class="title">MetaObjectHandler</span> </span>&#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertFill</span><span class="params">(MetaObject metaObject)</span> </span>&#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//重点是这个方法，第一个参数为需要设置的字段名，第二个是要设置的值</span></span><br><span class="line">setFieldValByName(<span class="string">&quot;lastUpdateTime&quot;</span>,LocalDateTime.now(),metaObject);</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateFill</span><span class="params">(MetaObject metaObject)</span> </span>&#123;</span><br><span class="line">insertFill(metaObject);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;blockquote class=&quot;blockquote-center&quot;&gt;
&lt;p&gt;MybBtis-Plus提供了AbstractWrapper抽象类，提供了很多SQL语法支持的方法，比如模糊查询，比较，区间，分组查询，排序，判断空，子查询等等，方便我们用面向对象的方式去实现sql语句；AbstractWrapper有两个常用的实现类，分别是QueryWrapper和UpdateWrapper，我们以后就用这两个实现类；&lt;/p&gt;

&lt;/blockquote&gt;</summary>
    
    
    
    <category term="Java" scheme="https://ifuxing.cool/categories/Java/"/>
    
    
    <category term="Efficient" scheme="https://ifuxing.cool/tags/Efficient/"/>
    
  </entry>
  
  <entry>
    <title>LomBok+MyBatis-Plus让你的代码更简介高效</title>
    <link href="https://ifuxing.cool/2020/02/17/MyBatisPlus+LomBok/"/>
    <id>https://ifuxing.cool/2020/02/17/MyBatisPlus+LomBok/</id>
    <published>2020-02-17T14:24:54.000Z</published>
    <updated>2020-11-30T03:47:52.772Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><ul><li>Lombok是一种Java实用工具，能通过注解的方式，在编译时自动为属性生成构造器,可用来帮助开发人员消除Java的冗长代码，尤其是对于简单的Java对象（POJO）。</li><li>Mybatis-Plus（简称 MP）是一个 MyBatis 的增强工具，在 MyBatis 的基础上只做增强不做改变，为简化开发、提高效率而生。</li></ul></blockquote><a id="more"></a><h1 id="一-Lombok"><a href="#一-Lombok" class="headerlink" title="一.Lombok"></a>一.Lombok</h1><p>Lombok能通过注解的方式，在编译时自动为属性生成构造器、getter/setter、equals、hashcode、toString方法。出现的神奇就是在源码中没有getter和setter方法，但是在编译生成的字节码文件中有getter和setter方法。这样就省去了手动重建这些代码的麻烦，使代码看起来更简洁些。</p><h3 id="1-工程中导入依赖"><a href="#1-工程中导入依赖" class="headerlink" title="1.工程中导入依赖"></a>1.工程中导入依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-下载插件"><a href="#2-下载插件" class="headerlink" title="2. 下载插件"></a>2. 下载插件</h3><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201123115040.png" alt="image-20201123115040589"></p><h3 id="3-使用Lombok"><a href="#3-使用Lombok" class="headerlink" title="3. 使用Lombok"></a>3. 使用Lombok</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataExample</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">double</span> score;</span><br><span class="line"><span class="keyword">private</span> String[] tags;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-相关注解"><a href="#4-相关注解" class="headerlink" title="4. 相关注解"></a>4. 相关注解</h3><p>这里列出常用注解，还有一些其他注解需要了解给大家推荐一个文章，<a href="https://mp.weixin.qq.com/s?__biz=Mzg2OTA0Njk0OA==&mid=2247485385&idx=2&sn=a7c3fb4485ffd8c019e5541e9b1580cd&chksm=cea24802f9d5c1144eee0da52cfc0cc5e8ee3590990de3bb642df4d4b2a8cd07f12dd54947b9&token=1667678311&lang=zh_CN&scene=21#wechat_redirect>">十分钟搞懂Java效率工具Lombok使用与原理</a>，这里面写的很详细</p><table><thead><tr><th>注解</th><th>解释</th></tr></thead><tbody><tr><td>@Data</td><td>@Getter @Setter @RequiredArgsConstructor @ToString @EqualsAndHashCode这5个注解的合集</td></tr><tr><td>@Setter</td><td>注解在属性上；为属性提供 setting 方法</td></tr><tr><td>@Getter</td><td>注解在属性上；为属性提供 getting 方法</td></tr><tr><td>@Slf4j</td><td>日志注解</td></tr><tr><td>@Synchronized</td><td>添加同步锁</td></tr><tr><td>@ToString</td><td>添加toString方法</td></tr><tr><td>@NoArgsConstructor</td><td>提供一个无参的构造方法</td></tr></tbody></table><h3 id="5-Accessors"><a href="#5-Accessors" class="headerlink" title="5. @Accessors"></a>5. @Accessors</h3><p>翻译是存取器。通过该注解可以控制getter和setter方法的形式</p><ul><li> fluent 若为true，则getter和setter方法的方法名都是属性名，且setter方法返回当前对象</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Accessors(fluent = true)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 生成的getter和setter方法如下，方法体略</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">id</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">id</span><span class="params">(Integer id)</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">name</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">name</span><span class="params">(String name)</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>chain 若为true，则setter方法返回当前对象</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Accessors(chain = true)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 生成的setter方法如下，方法体略</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">setId</span><span class="params">(Integer id)</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">setName</span><span class="params">(String name)</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>prefix 若为true，则getter和setter方法会忽视属性名的指定前缀（遵守驼峰命名）</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Accessors(prefix = &quot;f&quot;)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer fId;</span><br><span class="line">    <span class="keyword">private</span> String fName;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 生成的getter和setter方法如下，方法体略</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">id</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">id</span><span class="params">(Integer id)</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">name</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">name</span><span class="params">(String name)</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="二-MyBatis-Plus"><a href="#二-MyBatis-Plus" class="headerlink" title="二. MyBatis-Plus"></a>二. MyBatis-Plus</h2><h3 id="1-简介"><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介</h3><p>Mybatis-Plus（简称 MP）是一个 Mybatis 的增强工具，在 Mybatis 的基础上只做增强不做改变，为简化开发、提高效率而生。那么它是怎么增强的呢？其实就是它已经封装好了一些 crud 方法，我们不需要再写 xml 了，直接调用这些方法就行。</p><h3 id="2-特性"><a href="#2-特性" class="headerlink" title="2. 特性"></a>2. 特性</h3><table><thead><tr><th align="left">特性</th><th>解释</th></tr></thead><tbody><tr><td align="left"><strong>无侵入</strong></td><td>只做增强不做改变，引入它不会对现有工程产生影响</td></tr><tr><td align="left"><strong>损耗小</strong></td><td>启动即会自动注入基本 CURD，性能基本无损耗，直接面向对象操作</td></tr><tr><td align="left"><strong>强大的 CRUD 操作</strong></td><td>内置通用 Mapper、通用 Service，仅仅通过少量配置即可实现单表大部分 CRUD 操作，更有强大的条件构造器，满足各类使用需求</td></tr><tr><td align="left"><strong>支持 Lambda 形式调用</strong></td><td>通过 Lambda 表达式，方便的编写各类查询条件，无需再担心字段写错</td></tr><tr><td align="left"><strong>支持主键自动生成</strong></td><td>支持多达 4 种主键策略（内含分布式唯一 ID 生成器 - Sequence），可自由配置，完美解决主键问题</td></tr><tr><td align="left"><strong>支持自定义全局通用操作</strong></td><td>支持全局通用方法注入（ Write once, use anywhere ）</td></tr><tr><td align="left"><strong>内置代码生成器</strong></td><td>采用代码或者 Maven 插件可快速生成 Mapper 、 Model 、 Service 、 Controller 层代码，支持模板引擎，更有超多自定义配置等您来使用</td></tr><tr><td align="left"><strong>内置分页插件</strong></td><td>基于 MyBatis 物理分页，开发者无需关心具体操作，配置好插件之后，写分页等同于普通 List 查询</td></tr><tr><td align="left"><strong>分页插件支持多种数据库</strong></td><td>支持 MySQL、MariaDB、Oracle、DB2、H2、HSQL、SQLite、Postgre、SQLServer2005、SQLServer 等多种数据库</td></tr><tr><td align="left"><strong>内置性能分析插件</strong></td><td>可输出 Sql 语句以及其执行时间，建议开发测试时启用该功能，能快速揪出慢查询</td></tr><tr><td align="left"><strong>内置全局拦截插件</strong></td><td>提供全表 delete 、 update 操作智能分析阻断，也可自定义拦截规则，预防误操作</td></tr></tbody></table><h3 id="3-SpringBoot整合Mybatis-Plus"><a href="#3-SpringBoot整合Mybatis-Plus" class="headerlink" title="3. SpringBoot整合Mybatis-Plus"></a>3. SpringBoot整合Mybatis-Plus</h3><h4 id="3-1创建SpringBoot工程，引入Mybatis-Plus依赖"><a href="#3-1创建SpringBoot工程，引入Mybatis-Plus依赖" class="headerlink" title="3.1创建SpringBoot工程，引入Mybatis-Plus依赖"></a>3.1创建SpringBoot工程，引入Mybatis-Plus依赖</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Spring boot 版本信息 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--springboottest--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mybatis-plus 起步依赖--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;scope&gt;runtime&lt;/scope&gt;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mybatis-plus end--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-codec<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-codec<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-2-编写相关配置"><a href="#3-2-编写相关配置" class="headerlink" title="3.2 编写相关配置"></a>3.2 编写相关配置</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">mybatisPlus-demo</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://ip:3306/mp?serverTimezone=Asia/Shanghai</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">com.itheima:</span> <span class="string">debug</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9300</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># mybatis-plus相关配置</span></span><br><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">    <span class="attr">globle-config:</span></span><br><span class="line">        <span class="attr">db-config:</span></span><br><span class="line">          <span class="comment"># 表名前缀</span></span><br><span class="line">          <span class="attr">table-prefix:</span> <span class="string">tb_</span><span class="comment"># 数据库如果有统一的前缀名可以加这个，然后实体类可以省相关的注解</span></span><br><span class="line">            <span class="comment"># 主键的生产方式</span></span><br><span class="line">            <span class="attr">id-type:</span> <span class="string">auto</span></span><br></pre></td></tr></table></figure><h4 id="3-4建一个User表供测试使用"><a href="#3-4建一个User表供测试使用" class="headerlink" title="3.4建一个User表供测试使用"></a>3.4建一个User表供测试使用</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建数据库</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> mp;</span><br><span class="line"><span class="keyword">USE</span> mp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建测试表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`tb_user`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">&#x27;主键ID&#x27;</span>,</span><br><span class="line">  <span class="string">`user_name`</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;用户名&#x27;</span>,</span><br><span class="line">  <span class="string">`password`</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;密码&#x27;</span>,</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">varchar</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">  <span class="string">`age`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;年龄&#x27;</span>,</span><br><span class="line">  <span class="string">`email`</span> <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;邮箱&#x27;</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">1</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入测试数据</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_user`</span> (<span class="string">`id`</span>, <span class="string">`user_name`</span>, <span class="string">`password`</span>, <span class="string">`name`</span>, <span class="string">`age`</span>, <span class="string">`email`</span>) <span class="keyword">VALUES</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;zhangsan&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;18&#x27;</span>, <span class="string">&#x27;test1@itcast.cn&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_user`</span> (<span class="string">`id`</span>, <span class="string">`user_name`</span>, <span class="string">`password`</span>, <span class="string">`name`</span>, <span class="string">`age`</span>, <span class="string">`email`</span>) <span class="keyword">VALUES</span> (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;lisi&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;20&#x27;</span>, <span class="string">&#x27;test2@itcast.cn&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_user`</span> (<span class="string">`id`</span>, <span class="string">`user_name`</span>, <span class="string">`password`</span>, <span class="string">`name`</span>, <span class="string">`age`</span>, <span class="string">`email`</span>) <span class="keyword">VALUES</span> (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;wangwu&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;王五&#x27;</span>, <span class="string">&#x27;28&#x27;</span>, <span class="string">&#x27;test3@itcast.cn&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_user`</span> (<span class="string">`id`</span>, <span class="string">`user_name`</span>, <span class="string">`password`</span>, <span class="string">`name`</span>, <span class="string">`age`</span>, <span class="string">`email`</span>) <span class="keyword">VALUES</span> (<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;zhaoliu&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;赵六&#x27;</span>, <span class="string">&#x27;21&#x27;</span>, <span class="string">&#x27;test4@itcast.cn&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_user`</span> (<span class="string">`id`</span>, <span class="string">`user_name`</span>, <span class="string">`password`</span>, <span class="string">`name`</span>, <span class="string">`age`</span>, <span class="string">`email`</span>) <span class="keyword">VALUES</span> (<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;sunqi&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;孙七&#x27;</span>, <span class="string">&#x27;24&#x27;</span>, <span class="string">&#x27;test5@itcast.cn&#x27;</span>);</span><br></pre></td></tr></table></figure><h4 id="3-5-编写实体类（这里用来上述的LomBok）"><a href="#3-5-编写实体类（这里用来上述的LomBok）" class="headerlink" title="3.5 编写实体类（这里用来上述的LomBok）"></a>3.5 编写实体类（这里用来上述的LomBok）</h4><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201115170915.png" alt="image-20201115170915485"></p><h4 id="3-5-编写mapper"><a href="#3-5-编写mapper" class="headerlink" title="3.5 编写mapper"></a>3.5 编写mapper</h4><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201115182957.png" alt="image-20201115182914784"></p><h4 id="3-6编写启动类"><a href="#3-6编写启动类" class="headerlink" title="3.6编写启动类"></a>3.6编写启动类</h4><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201123143037.png" alt="image-20201123143037717"></p><h3 id="4-基础的增删改查"><a href="#4-基础的增删改查" class="headerlink" title="4. 基础的增删改查"></a>4. 基础的增删改查</h3><h4 id="4-1-增加"><a href="#4-1-增加" class="headerlink" title="4.1 增加"></a>4.1 增加</h4> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">()</span></span>&#123;</span><br><span class="line">     <span class="comment">//先创建一个要添加的对象，</span></span><br><span class="line">     User user = <span class="keyword">new</span> User();</span><br><span class="line">     user.setName(<span class="string">&quot;kobe&quot;</span>);</span><br><span class="line">     user.setAge(<span class="number">18</span>);</span><br><span class="line">     user.setPassword(<span class="string">&quot;1231421&quot;</span>);</span><br><span class="line">     user.setUserName(<span class="string">&quot;925555&quot;</span>);</span><br><span class="line">     <span class="keyword">int</span> result = userDao.insert(user);</span><br><span class="line">     System.out.println(result);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h4 id="4-2-删除"><a href="#4-2-删除" class="headerlink" title="4.2  删除"></a>4.2  删除</h4><p>四种删除方法</p><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201115200013.png" alt="image-20201115200013776"></p><p>代码实现</p><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201115195839.png" alt="image-20201115195839105"></p><h4 id="4-3-更新"><a href="#4-3-更新" class="headerlink" title="4.3  更新"></a>4.3  更新</h4><p>两种更新方法</p><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201115200423.png" alt="image-20201115200423286"></p><p>代码实现</p><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201115201337.png" alt="image-20201115201337151"></p><h4 id="4-4-分页查询"><a href="#4-4-分页查询" class="headerlink" title="4.4 分页查询"></a>4.4 分页查询</h4><p><strong>代码实现</strong></p><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201125162739.png" alt="image-20201125162739555"></p><p><strong>注意事项</strong></p><p>使用mp的分页查询必须要设置一个拦截器</p><p><strong>3.4.0之前的版本用这个</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> PaginationInterceptor <span class="title">paginationInterceptor</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> PaginationInterceptor();</span><br><span class="line">&#125;</span><br><span class="line">  </span><br></pre></td></tr></table></figure><p><strong>3.4.0之后提供的拦截器配置方式</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> MybaticPlusInterceptor <span class="title">mybatisPlusInterceptor</span><span class="params">()</span></span>&#123;</span><br><span class="line">    MybatisPlusInterceptor mybatisPlusInterceptor = <span class="keyword">new</span> MybatisPlusInterceptor();</span><br><span class="line">    mybatisPlusInterceptor .addInnerInterceptor(<span class="keyword">new</span> PaginationInnerceptor());</span><br><span class="line">    <span class="keyword">return</span> mybatisPlusInterceptor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-MyBatis-plus封装service层"><a href="#5-MyBatis-plus封装service层" class="headerlink" title="5. MyBatis-plus封装service层"></a>5. MyBatis-plus封装service层</h3><h4 id="5-1接口"><a href="#5-1接口" class="headerlink" title="5.1接口"></a>5.1接口</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//接口继承IService</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> <span class="keyword">extends</span> <span class="title">IService</span>&lt;<span class="title">User</span>&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-2-实现类"><a href="#5-2-实现类" class="headerlink" title="5.2 实现类"></a>5.2 实现类</h4><p>​        这里可以用**this.getBaseMapper()**，这个方法的返回值 是继承继承BaseMapper的Mapper接口，所以可以直接调用UserMapper接口中的方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//实现类继承ServiceImpl&lt;Mapper,Entity&gt;实现定义接口</span></span><br><span class="line"><span class="comment">//其中Mapper为该接口对应的Mapper接口，Entity是对应的实体类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">extends</span> <span class="title">ServiceImpl</span>&lt;<span class="title">UserMapper</span>,<span class="title">User</span>&gt; <span class="keyword">implements</span> <span class="title">UserService</span></span>&#123;</span><br><span class="line">   </span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;blockquote class=&quot;blockquote-center&quot;&gt;
&lt;ul&gt;
&lt;li&gt;Lombok是一种Java实用工具，能通过注解的方式，在编译时自动为属性生成构造器,可用来帮助开发人员消除Java的冗长代码，尤其是对于简单的Java对象（POJO）。&lt;/li&gt;
&lt;li&gt;Mybatis-Plus（简称 MP）是一个 MyBatis 的增强工具，在 MyBatis 的基础上只做增强不做改变，为简化开发、提高效率而生。&lt;/li&gt;
&lt;/ul&gt;

&lt;/blockquote&gt;</summary>
    
    
    
    <category term="Java" scheme="https://ifuxing.cool/categories/Java/"/>
    
    
    <category term="Efficient" scheme="https://ifuxing.cool/tags/Efficient/"/>
    
  </entry>
  
  <entry>
    <title>简述Spring Boot原理分析_</title>
    <link href="https://ifuxing.cool/2019/02/13/%E7%AE%80%E8%BF%B0SpringBoot%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/"/>
    <id>https://ifuxing.cool/2019/02/13/%E7%AE%80%E8%BF%B0SpringBoot%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/</id>
    <published>2019-02-13T11:46:25.000Z</published>
    <updated>2020-12-09T10:22:46.160Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>Spring Boot基于Spring4.0设计的，不仅继承了Spring框架原有的优秀特性，而且还通过简化配置来进一步简化了Spring应用的整个搭建和开发过程。另外Spring Boot通过集成大量的框架使得依赖包的版本冲突，以及引用的不稳定性等问题得到了很好的解决。以下纯属个人简单的了解，并没有列出源码深入叙述，是为了帮助自己更好的理解Spring Boot。</p></blockquote><a id="more"></a><h2 id="一-自动配置原理"><a href="#一-自动配置原理" class="headerlink" title="一. 自动配置原理"></a>一. 自动配置原理</h2><h3 id="1-Conditional注解"><a href="#1-Conditional注解" class="headerlink" title="1. @Conditional注解"></a>1. @Conditional注解</h3><p>@Condition是Spring4.0后引入的条件化配置接口，通过实现Condition接口可以完成有条件的加载相应的Bean</p><p>@Conditional要配和Condition的实现类（ClassCondition）进行使用</p><ul><li><h4 id="实现流程"><a href="#实现流程" class="headerlink" title="实现流程"></a>实现流程</h4><ol><li><p>加上@Conditionl注解后会对这个已经注入到Spring的IOC容器中Bean进行判断，该注解有很多实现类，是根据各种不同的情况来判断，大多通过获取注解中的字节码文件来进行判断，可以根据所有的方法名来了解该功能</p></li><li><p>是根据Condition接口中的matches方法的返回值进行判断，该方法有两个参数对象，ConditionContext context和AnnotatedTypeMetadata metadata</p><ul><li>context：上下文对象，用来获取环境，IOC容器和ClassLoader对象</li><li>metadata：注解元对象，用来获取注解定义的属性值，通过getAnnotationAttributes方法获取</li></ul></li><li><p>true则将Spring IOC容器中的Bean进行加载，否则不加载</p></li><li><p>常用条件注解</p><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/self-disciplined/pic_star@main/notes-pic/20201103210940.png" alt="image-20201103210939890"></p></li><li><p>代码示例</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserConfig</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">      <span class="meta">@Bean</span></span><br><span class="line">      <span class="comment">//字节码存在则加载下面的Bean</span></span><br><span class="line">      <span class="meta">@ConditionOnClass(&quot;com.alibaba.fastjson.JSON&quot;)</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> User <span class="title">user</span><span class="params">()</span></span>&#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">new</span> User();</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      <span class="meta">@Bean</span></span><br><span class="line">      <span class="meta">@ConditionalOnProperty(name = &quot;itcast&quot;,havingValue = &quot;itheima&quot;)</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> User <span class="title">user2</span><span class="params">()</span></span>&#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">new</span> User();</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li></ol></li></ul><h3 id="2-切换内置服务器"><a href="#2-切换内置服务器" class="headerlink" title="2. 切换内置服务器"></a>2. 切换内置服务器</h3><ul><li><h4 id="流程："><a href="#流程：" class="headerlink" title="流程："></a>流程：</h4><ol><li>在pom文件中将starter-web的依赖中排除starter-tomcat的依赖</li><li>加入starter-jetty的依赖即可</li></ol></li><li><h4 id="原理："><a href="#原理：" class="headerlink" title="原理："></a>原理：</h4><ul><li>同样是根据@Condition注解的原理判断是否存在相关以来的类的字节码名称，存在才会加载Spring的IOC容器中的相关的bean</li></ul></li></ul><h3 id="3-Enable-的相关注解"><a href="#3-Enable-的相关注解" class="headerlink" title="3. @Enable* 的相关注解"></a>3. @Enable* 的相关注解</h3><ul><li>用于动态开启某种功能（就是获取相关类及其所含方法），<strong>底层原理的就是使用@import注解导入一些配置类，实现Bean的动态加载</strong></li><li><strong>注意：</strong>Spring Boot工程不能直接获取jar包中定义的Bean<ul><li>原因：@ComponentScan的扫描范围是当前引导类所在的包及其子包</li><li>解决：<ol><li>使用@ComponentScan扫描com.itheima.config（配置类）</li><li>可使用@import注解来加载类，使这些类都会被Spring创建，并注入IOC容器</li><li>将上述的@import注解进行封装并使用</li></ol></li></ul></li></ul><h3 id="4-Import注解"><a href="#4-Import注解" class="headerlink" title="4. @Import注解"></a>4. @Import注解</h3><ul><li><p>@Enable*底层依赖于@Import注解导入一些类，使用@Import导入的类会被Spring加载到IOC容器中。而@Import提供4中用法：</p><ol><li><p><strong>导入Bean</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Import(User.class)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">      ConfigurableApplicationContext context = SpringApplication.run(Spring BootEnableApplication.class, args);</span><br><span class="line">  </span><br><span class="line">      <span class="comment">//直接导入Bean创建出来的名字不一定与导入的相同，需要用这个方法查看一下</span></span><br><span class="line">      User user = context.getBean(User.class); </span><br><span class="line">      System.out.println(user);</span><br><span class="line">  </span><br><span class="line">      Role role = context.getBean(Role.class);</span><br><span class="line">      System.out.println(role);</span><br><span class="line">      Map&lt;String, User  map = context.getBeansOfType(User.class);</span><br><span class="line">      System.out.println(map);</span><br><span class="line">  </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>导入配置类</strong></p><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201107145805.png" alt="image-20201107145805680"></p></li><li><p><strong>导入 ImportSelector 实现类。一般用于加载配置文件中的类</strong></p><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201107151352.png" alt="image-20201107151352162"></p></li><li><p><strong>导入 ImportBeanDefinitionRegistrar 实现类。</strong></p><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201107154713.png" alt="image-20201107154713551"></p></li></ol></li></ul><p>​    </p><h3 id="5-EnableAutoConfiguration"><a href="#5-EnableAutoConfiguration" class="headerlink" title="5. @EnableAutoConfiguration"></a>5. @EnableAutoConfiguration</h3><ul><li><strong>介绍</strong><ol><li>@EnableAutoConfiguration 注解内部使用@Import(AutoConfigurationImportSelector.class)来加载配置类。 </li><li> 配置文件位置：META-INF/spring.factories，该配置文件中定义了大量的配置类，当 Spring Boot 应用启动时，会自动加载这些配置类，初始化Bean</li><li>==注意：==并不是所有的Bean都会被初始化，在配置类中使用Condition来加载满足条件的Bean</li></ol></li></ul><h3 id="6-自定义starter步骤分析"><a href="#6-自定义starter步骤分析" class="headerlink" title="6. 自定义starter步骤分析"></a>6. 自定义starter步骤分析</h3><ul><li><p><strong>需求：</strong></p></li><li><p>自定义redis-starter，要求当导入redis坐标时，Spring Boot自动创建Jedis的Bean。</p><ul><li><strong>步骤：</strong></li></ul></li></ul><ol><li>创建 redis-spring-boot-autoconfigure 模块<ol start="2"><li>创建 redis-spring-boot-starter 模块,依赖 redis-spring-boot-autoconfigure的模块</li><li>在 redis-spring-boot-autoconfigure 模块中初始化 Jedis 的 Bean。并定义META-INF/spring.factories 文件</li><li>在测试模块中引入自定义的 redis-starter 依赖，测试获取 Jedis 的Bean，操作 redis。</li></ol></li></ol><hr><h2 id="二-事件监听"><a href="#二-事件监听" class="headerlink" title="二.事件监听"></a>二.事件监听</h2><h4 id="1-简介"><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介</h4><ul><li>Java中的事件监听机制定义了以下几个角色：</li><li><ol><li>事件：Event，继承 java.util.EventObject 类的对象</li><li>事件源：Source ，任意对象Object</li><li>监听器：Listener，实现 java.util.EventListener 接口 的对象</li></ol></li></ul><h4 id="2-Spring-Boot-在项目启动时，会对几个监听器进行回调"><a href="#2-Spring-Boot-在项目启动时，会对几个监听器进行回调" class="headerlink" title="2. Spring Boot 在项目启动时，会对几个监听器进行回调"></a>2. Spring Boot 在项目启动时，会对几个监听器进行回调</h4><ul><li><strong>其中：</strong><ul><li>MyApplicationRunner和MyCommandLineRunner都是当项目启动后执行，使用@Component放入容器即可使用</li><li>MyApplicationContextInitializer和SpringApplicationRunListener的使用时,要在resource文件夹下添加META-INF/spring.factories,在配置文件中加入配置</li></ul></li></ul><ol><li><p>ApplicationRunner</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 当项目启动后执行run方法。</span></span><br><span class="line"><span class="comment"> * 可以在项目启动时，自动调用run方法，比如需要在项目开启时加入数据库缓存，（缓存预热）</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyApplicationRunner</span> <span class="keyword">implements</span> <span class="title">ApplicationRunner</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(ApplicationArguments args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ApplicationRunner...run&quot;</span>);</span><br><span class="line">        System.out.println(Arrays.asList(args.getSourceArgs()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></li><li><p>CommandLineRunner</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyCommandLineRunner</span> <span class="keyword">implements</span> <span class="title">CommandLineRunner</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(String... args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;CommandLineRunner...run&quot;</span>);</span><br><span class="line">        System.out.println(Arrays.asList(args));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ApplicationContextInitializer</p><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201107211340.png" alt="image-20201107211340369"></p></li><li><p>SpringApplicationRunListener</p></li></ol><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201107212127.png" alt="image-20201107212127309"></p><h2 id="三-启动流程图"><a href="#三-启动流程图" class="headerlink" title="三. 启动流程图"></a>三. 启动流程图</h2><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201107222428.png"></p>]]></content>
    
    
    <summary type="html">&lt;blockquote class=&quot;blockquote-center&quot;&gt;
&lt;p&gt;Spring Boot基于Spring4.0设计的，不仅继承了Spring框架原有的优秀特性，而且还通过简化配置来进一步简化了Spring应用的整个搭建和开发过程。另外Spring Boot通过集成大量的框架使得依赖包的版本冲突，以及引用的不稳定性等问题得到了很好的解决。以下纯属个人简单的了解，并没有列出源码深入叙述，是为了帮助自己更好的理解Spring Boot。&lt;/p&gt;

&lt;/blockquote&gt;</summary>
    
    
    
    <category term="Java" scheme="https://ifuxing.cool/categories/Java/"/>
    
    
    <category term="Spring Boot" scheme="https://ifuxing.cool/tags/Spring-Boot/"/>
    
  </entry>
  
  <entry>
    <title>POI以及EasyExcel的整理</title>
    <link href="https://ifuxing.cool/2019/01/07/POI%E4%BB%A5%E5%8F%8AEasyExcel%E7%9A%84%E6%95%B4%E7%90%86/"/>
    <id>https://ifuxing.cool/2019/01/07/POI%E4%BB%A5%E5%8F%8AEasyExcel%E7%9A%84%E6%95%B4%E7%90%86/</id>
    <published>2019-01-07T14:37:15.000Z</published>
    <updated>2020-12-09T10:22:25.506Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>POI和EasyExcel是目前两种最常见的excel等文件的读写工具，最近项目需要过来提前学习了解一下，简单做一遍总结加深一下自己的印象，了解流程，还有许多进阶的API没有总结，等到用的时候有问题在做总结把。</p></blockquote><a id="more"></a><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201206210823.png" alt="image-20201206210753670"></p><h2 id="一-POI"><a href="#一-POI" class="headerlink" title="一. POI"></a>一. POI</h2><h3 id="1-基本功能"><a href="#1-基本功能" class="headerlink" title="1. 基本功能"></a>1. 基本功能</h3><ul><li>==HSSF==（读写.xsl格式的Excel文件）</li><li>==XSSF==（读写.xlsx格式的Excel文件）</li><li>HWPF（读写Word格式文件）</li><li>HSLF（读写PPT格式文件）</li><li>HDGF（Visio格式文件）</li></ul><p><a href="https://github.com/alibaba/easyexcel">官网地址</a></p><h3 id="2-Excel写"><a href="#2-Excel写" class="headerlink" title="2. Excel写"></a>2. Excel写</h3><p><strong>步骤：</strong></p><ol><li><p>创建Maven项目</p></li><li><p>导入pom依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--xls(03)--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--xlsx(07)--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--日期格式化工具--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>joda-time<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>joda-time<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.10.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--test--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>代码实现（elsx文件只需要将HSSDWorkbook换成HSSFWorkbook）</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelWriteTest</span></span>&#123;</span><br><span class="line">String path = <span class="string">&quot;E:\\Users\\fuxing\\IdeaProjects\\POIDemo\\src&quot;</span>;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWriteHSSF</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="comment">// 创建新的Excel 工作簿</span></span><br><span class="line">    Workbook workbook = <span class="keyword">new</span> HSSFWorkbook();</span><br><span class="line">    <span class="comment">// 如要新建一名为&quot;会员登录统计&quot;的工作表，其语句为：</span></span><br><span class="line">    Sheet sheet = workbook.createSheet(<span class="string">&quot;star&quot;</span>);</span><br><span class="line">    <span class="comment">// 创建行（row 1）</span></span><br><span class="line">    Row row1 = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">// 创建单元格（col 1-1）</span></span><br><span class="line">    Cell cell11 = row1.createCell(<span class="number">0</span>);</span><br><span class="line">    cell11.setCellValue(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">    <span class="comment">// 创建单元格（col 1-2）</span></span><br><span class="line">    Cell cell12 = row1.createCell(<span class="number">1</span>);</span><br><span class="line">    cell12.setCellValue(<span class="string">&quot;kobe&quot;</span>);</span><br><span class="line">    <span class="comment">// 创建行（row 2）</span></span><br><span class="line">    Row row2 = sheet.createRow(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">// 创建单元格（col 2-1）</span></span><br><span class="line">    Cell cell21 = row2.createCell(<span class="number">0</span>);</span><br><span class="line">    cell21.setCellValue(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">    <span class="comment">//创建单元格（第三列）</span></span><br><span class="line">    Cell cell22 = row2.createCell(<span class="number">1</span>);</span><br><span class="line">    cell22.setCellValue(<span class="number">18</span>);</span><br><span class="line">    <span class="comment">// 新建一输出文件流（注意：要先创建文件夹）</span></span><br><span class="line">    FileOutputStream out = <span class="keyword">new</span> FileOutputStream(path+<span class="string">&quot;star02.xls&quot;</span>);</span><br><span class="line">    <span class="comment">// 把相应的Excel 工作簿存盘</span></span><br><span class="line">    workbook.write(out);</span><br><span class="line">    <span class="comment">// 操作结束，关闭文件</span></span><br><span class="line">    out.close();</span><br><span class="line">    System.out.println(<span class="string">&quot;文件生成成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol><p>==注意事项==</p><ul><li>xls和xslx两个版本写的过程只有创建的对象不同，方法一样</li><li>xls最多只有65535行，优点：过程中写入缓存，不操作磁盘，最后一次性写入磁盘，速度快</li><li>xlsx的优点：可以写较大的数据量，如20万条</li><li>xlsx的缺点：写数据时非常慢，非常耗内存，也有可能发生内存溢出</li></ul><p>==大文件写SXSSF==</p><ul><li>优点：可以写非常大的数据量，如100万条甚至更多条，写数据速度快，占用更少的内存</li><li>注意：<ul><li>过程中会产生临时文件，需要清理临时文件</li><li>默认由100条记录被保存在内存中，如果超过这数量，则最前面的数据被写入临时文件</li><li>如果想自定义内存中数据的数量，可以使用new SXSSFWorkbook ( 数量 )    </li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrite07BigDataFast</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"><span class="comment">//记录开始时间</span></span><br><span class="line"><span class="keyword">long</span> begin = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建一个SXSSFWorkbook、XSSFWorkbook</span></span><br><span class="line">Workbook workbook = <span class="keyword">new</span> SXSSFWorkbook();</span><br><span class="line"><span class="comment">//创建一个sheet</span></span><br><span class="line">Sheet sheet = workbook.createSheet();</span><br><span class="line"></span><br><span class="line"><span class="comment">//xls文件最大支持65536行</span></span><br><span class="line"><span class="comment">//XSSF效率较差</span></span><br><span class="line"><span class="comment">//SXSSF效率最高</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> rowNum = <span class="number">0</span>; rowNum &lt; <span class="number">100000</span>; rowNum++) &#123;</span><br><span class="line"><span class="comment">//创建一个行</span></span><br><span class="line">Row row = sheet.createRow(rowNum);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> cellNum = <span class="number">0</span>; cellNum &lt; <span class="number">10</span>; cellNum++) &#123;<span class="comment">//创建单元格</span></span><br><span class="line">Cell cell = row.createCell(cellNum);</span><br><span class="line">cell.setCellValue(cellNum);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;done&quot;</span>);</span><br><span class="line">FileOutputStream out = <span class="keyword">new</span> FileOutputStream(path+<span class="string">&quot;bigdata07-fast.xlsx&quot;</span>);</span><br><span class="line">workbook.write(out);</span><br><span class="line"><span class="comment">// 操作结束，关闭文件</span></span><br><span class="line">out.close();</span><br><span class="line"></span><br><span class="line"><span class="comment">//清除临时文件</span></span><br><span class="line">((SXSSFWorkbook)workbook).dispose();</span><br><span class="line"></span><br><span class="line"><span class="comment">//记录结束时间</span></span><br><span class="line"><span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">System.out.println((<span class="keyword">double</span>)(end - begin)/<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-Excel写"><a href="#3-Excel写" class="headerlink" title="3. Excel写"></a>3. Excel写</h3><h4 id="3-1常规的读"><a href="#3-1常规的读" class="headerlink" title="3.1常规的读"></a>3.1常规的读</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testRead03</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">InputStream is = <span class="keyword">new</span> FileInputStream(path+<span class="string">&quot;star03.xls&quot;</span>);</span><br><span class="line"><span class="comment">//如果读xlsx文件将对象换为XSSFWorkbook</span></span><br><span class="line">Workbook workbook = <span class="keyword">new</span> HSSFWorkbook(is);</span><br><span class="line">Sheet sheet = workbook.getSheetAt(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取第一行第一列</span></span><br><span class="line">Row row = sheet.getRow(<span class="number">0</span>);</span><br><span class="line">Cell cell = row.getCell(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出单元内容</span></span><br><span class="line">System.out.println(cell.getStringCellValue());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 操作结束，关闭文件</span></span><br><span class="line">is.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="3-2-读取不同的数据类型"><a href="#3-2-读取不同的数据类型" class="headerlink" title="3.2 读取不同的数据类型"></a>3.2 读取不同的数据类型</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCellType</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123; </span><br><span class="line">    InputStream is = <span class="keyword">new</span> FileInputStream(path+<span class="string">&quot;/会员消费商品明细表.xls&quot;</span>);</span><br><span class="line">    Workbook workbook = <span class="keyword">new</span> HSSFWorkbook(is);</span><br><span class="line">    Sheet sheet = workbook.getSheetAt(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取标题所有内容</span></span><br><span class="line">    Row rowTitle = sheet.getRow(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (rowTitle != <span class="keyword">null</span>) &#123;<span class="comment">// 行不为空</span></span><br><span class="line">        <span class="comment">// 读取cell</span></span><br><span class="line">        <span class="keyword">int</span> cellCount = rowTitle.getPhysicalNumberOfCells();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> cellNum = <span class="number">0</span>; cellNum &lt; cellCount; cellNum++) &#123;</span><br><span class="line">             Cell cell = rowTitle.getCell(cellNum);</span><br><span class="line">             <span class="keyword">if</span> (cell != <span class="keyword">null</span>) &#123;</span><br><span class="line">                 <span class="keyword">int</span> cellType = cell.getCellType();</span><br><span class="line">                 String cellValue = cell.getStringCellValue();</span><br><span class="line">                 System.out.print(cellValue + <span class="string">&quot;|&quot;</span>);</span><br><span class="line">             &#125;</span><br><span class="line">        &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment">// 读取商品列表数据</span></span><br><span class="line">    <span class="keyword">int</span> rowCount = sheet.getPhysicalNumberOfRows();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> rowNum = <span class="number">1</span>; rowNum &lt; rowCount; rowNum++) &#123;</span><br><span class="line">        Row rowData = sheet.getRow(rowNum);</span><br><span class="line">        <span class="keyword">if</span> (rowData != <span class="keyword">null</span>) &#123;<span class="comment">// 行不为空</span></span><br><span class="line">            <span class="comment">// 读取cell</span></span><br><span class="line">            <span class="keyword">int</span> cellCount = rowTitle.getPhysicalNumberOfCells();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> cellNum = <span class="number">0</span>; cellNum &lt; cellCount; cellNum++) &#123;</span><br><span class="line">             System.out.print(<span class="string">&quot;【&quot;</span> + (rowNum + <span class="number">1</span>) + <span class="string">&quot;-&quot;</span> + (cellNum + <span class="number">1</span>) +<span class="string">&quot;】&quot;</span>);</span><br><span class="line">            Cell cell = rowData.getCell(cellNum);</span><br><span class="line">            <span class="keyword">if</span> (cell != <span class="keyword">null</span>) &#123;</span><br><span class="line">                 <span class="keyword">int</span> cellType = cell.getCellType();</span><br><span class="line">                   <span class="comment">//判断单元格数据类型</span></span><br><span class="line">                  String cellValue = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                  <span class="keyword">switch</span> (cellType) &#123;</span><br><span class="line">                      <span class="keyword">case</span> HSSFCell.CELL_TYPE_STRING:<span class="comment">//字符串</span></span><br><span class="line">                          System.out.print(<span class="string">&quot;【STRING】&quot;</span>);</span><br><span class="line">                          cellValue = cell.getStringCellValue();</span><br><span class="line">                          <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                      <span class="keyword">case</span> HSSFCell.CELL_TYPE_BOOLEAN:<span class="comment">//布尔</span></span><br><span class="line">                          System.out.print(<span class="string">&quot;【BOOLEAN】&quot;</span>);</span><br><span class="line">                          cellValue =                           String.valueOf(cell.getBooleanCellValue());</span><br><span class="line">                          <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                      <span class="keyword">case</span> HSSFCell.CELL_TYPE_BLANK:<span class="comment">//空</span></span><br><span class="line">                          System.out.print(<span class="string">&quot;【BLANK】&quot;</span>);</span><br><span class="line">                          <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                      <span class="keyword">case</span> HSSFCell.CELL_TYPE_NUMERIC:</span><br><span class="line">                          System.out.print(<span class="string">&quot;【NUMERIC】&quot;</span>);                           String.valueOf(cell.getNumericCellValue());</span><br><span class="line"></span><br><span class="line">                      <span class="keyword">if</span> (HSSFDateUtil.isCellDateFormatted(cell)) &#123;<span class="comment">//</span></span><br><span class="line">                                    日期</span><br><span class="line">                      System.out.print(<span class="string">&quot;【日期】&quot;</span>);</span><br><span class="line">                      Date date = cell.getDateCellValue();</span><br><span class="line">                      cellValue = <span class="keyword">new</span></span><br><span class="line">                                         DateTime(date).toString(<span class="string">&quot;yyyy-MM-dd&quot;</span>);</span><br><span class="line">                      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                    <span class="comment">// 不是日期格式，则防止当数字过长时以科学计数法显示</span></span><br><span class="line">                      System.out.print(<span class="string">&quot;【转换成字符串】&quot;</span>);                          cell.setCellType(HSSFCell.CELL_TYPE_STRING);</span><br><span class="line">                    cellValue = cell.toString();</span><br><span class="line">                                &#125;</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                      <span class="keyword">case</span> Cell.CELL_TYPE_ERROR:</span><br><span class="line">                      System.out.print(<span class="string">&quot;【数据类型错误】&quot;</span>);</span><br><span class="line">                      <span class="keyword">break</span>;</span><br><span class="line">                      &#125;</span><br><span class="line">                      System.out.println(cellValue);</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      is.close();</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h2 id="二-EasyExcel操作"><a href="#二-EasyExcel操作" class="headerlink" title="二. EasyExcel操作"></a>二. EasyExcel操作</h2><p>具体的进阶在需要的时候查官方api就行</p><p><a href="https://www.yuque.com/easyexcel">官方网站</a></p><h3 id="1-EasyExcel写"><a href="#1-EasyExcel写" class="headerlink" title="1.EasyExcel写"></a>1.EasyExcel写</h3><h4 id="1-1-导入依赖和实体类"><a href="#1-1-导入依赖和实体类" class="headerlink" title="1.1 导入依赖和实体类"></a>1.1 导入依赖和实体类</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>easyexcel<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoData</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;字符串标题&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String string;</span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;日期标题&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;数字标题&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Double doubleData;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 忽略这个字段</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelIgnore</span></span><br><span class="line">    <span class="keyword">private</span> String ignore;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/loading.png" data-original="https://cdn.jsdelivr.net/gh/ifuxing/pic_star@main/notes-pic/20201206194704.png" alt="image-20201206194627116"></p><h4 id="1-2-代码示例"><a href="#1-2-代码示例" class="headerlink" title="1.2 代码示例"></a>1.2 代码示例</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EasyExcelTest</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 最简单的写</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> DemoData&#125;</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;2. 直接写即可</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">simpleWrite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 写法1</span></span><br><span class="line">        String path = <span class="string">&quot;E:\\Users\\fuxing\\IdeaProjects\\POIDemo\\src&quot;</span>;</span><br><span class="line">        String fileName = path + <span class="string">&quot;star666.xlsx&quot;</span>;</span><br><span class="line">        <span class="comment">// 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span></span><br><span class="line">        <span class="comment">// 如果这里想使用03 则 传入excelType参数即可</span></span><br><span class="line">        <span class="comment">//write（fileName，格式类）</span></span><br><span class="line">        <span class="comment">//sheet（表名）</span></span><br><span class="line">        <span class="comment">//doWrite（数据）</span></span><br><span class="line">        EasyExcel.write(fileName, DemoData.class).sheet(<span class="string">&quot;模板&quot;</span>).doWrite(data());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> List&lt;DemoData&gt; <span class="title">data</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;DemoData&gt; list = <span class="keyword">new</span> ArrayList&lt;DemoData&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            DemoData data = <span class="keyword">new</span> DemoData();</span><br><span class="line">            data.setString(<span class="string">&quot;字符串&quot;</span> + i);</span><br><span class="line">            data.setDate(<span class="keyword">new</span> Date());</span><br><span class="line">            data.setDoubleData(<span class="number">0.56</span>);</span><br><span class="line">            list.add(data);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-EasyExcel读"><a href="#2-EasyExcel读" class="headerlink" title="2. EasyExcel读"></a>2. EasyExcel读</h3><h4 id="2-1要写一个监听类"><a href="#2-1要写一个监听类" class="headerlink" title="2.1要写一个监听类"></a>2.1要写一个监听类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EasyExcelTest</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 最简单的写</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> DemoData&#125;</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;2. 直接写即可</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String path = <span class="string">&quot;E:\\Users\\fuxing\\IdeaProjects\\POIDemo\\src&quot;</span>;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">simpleWrite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 写法1</span></span><br><span class="line"></span><br><span class="line">        String fileName = path + <span class="string">&quot;star666.xlsx&quot;</span>;</span><br><span class="line">        <span class="comment">// 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span></span><br><span class="line">        <span class="comment">// 如果这里想使用03 则 传入excelType参数即可</span></span><br><span class="line">        EasyExcel.write(fileName, DemoData.class).sheet(<span class="string">&quot;模板&quot;</span>).doWrite(data());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> List&lt;DemoData&gt; <span class="title">data</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;DemoData&gt; list = <span class="keyword">new</span> ArrayList&lt;DemoData&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            DemoData data = <span class="keyword">new</span> DemoData();</span><br><span class="line">            data.setString(<span class="string">&quot;字符串&quot;</span> + i);</span><br><span class="line">            data.setDate(<span class="keyword">new</span> Date());</span><br><span class="line">            data.setDoubleData(<span class="number">0.56</span>);</span><br><span class="line">            list.add(data);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">simpleRead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 有个很重要的点 DemoDataListener 不能被spring管理，要每次读取excel都要new,然后里面用到spring可以构造方法传进去</span></span><br><span class="line">        <span class="comment">// 写法1：</span></span><br><span class="line">        String fileName = path + <span class="string">&quot;star666.xlsx&quot;</span>;</span><br><span class="line">        <span class="comment">// 这里 需要指定读用哪个class去读，然后读取第一个sheet 文件流会自动关闭</span></span><br><span class="line">        EasyExcel.read(fileName, DemoData.class, <span class="keyword">new</span> DemoDataListener()).sheet().doRead();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-2-持久层"><a href="#2-2-持久层" class="headerlink" title="2.2 持久层"></a>2.2 持久层</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 假设这个是你的DAO存储。当然还要这个类让spring管理，当然你不用需要存储，也不需要这个类。</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoDAO</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(List&lt;DemoData&gt; list)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 如果是mybatis,尽量别直接调用多次insert,自己写一个mapper里面新增一个方法batchInsert,所有数据一次性插入</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-3-测试类"><a href="#2-3-测试类" class="headerlink" title="2.3 测试类"></a>2.3 测试类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">simpleRead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 有个很重要的点 DemoDataListener 不能被spring管理，要每次读取excel都要new,然后里面用到spring可以构造方法传进去</span></span><br><span class="line">        <span class="comment">// 写法1：</span></span><br><span class="line">        String fileName = path + <span class="string">&quot;star666.xlsx&quot;</span>;</span><br><span class="line">        <span class="comment">// 这里 需要指定读用哪个class去读，然后读取第一个sheet 文件流会自动关闭</span></span><br><span class="line">        EasyExcel.read(fileName, DemoData.class, <span class="keyword">new</span> DemoDataListener()).sheet().doRead();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;blockquote class=&quot;blockquote-center&quot;&gt;
&lt;p&gt;POI和EasyExcel是目前两种最常见的excel等文件的读写工具，最近项目需要过来提前学习了解一下，简单做一遍总结加深一下自己的印象，了解流程，还有许多进阶的API没有总结，等到用的时候有问题在做总结把。&lt;/p&gt;

&lt;/blockquote&gt;</summary>
    
    
    
    <category term="Java" scheme="https://ifuxing.cool/categories/Java/"/>
    
    
    <category term="Excel" scheme="https://ifuxing.cool/tags/Excel/"/>
    
  </entry>
  
  <entry>
    <title>测试</title>
    <link href="https://ifuxing.cool/2018/12/13/%E6%A8%A1%E6%9D%BF%E6%B5%8B%E8%AF%95/"/>
    <id>https://ifuxing.cool/2018/12/13/%E6%A8%A1%E6%9D%BF%E6%B5%8B%E8%AF%95/</id>
    <published>2018-12-13T12:46:25.000Z</published>
    <updated>2020-11-30T03:42:02.369Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>不论什么时候，心里要有爱，眼里要有光</p></blockquote><a id="more"></a><div class="note success"><p>我爱科比</p></div><p><a href="https://ifuxing.cool>">我爱科比</a></p>]]></content>
    
    
    <summary type="html">&lt;blockquote class=&quot;blockquote-center&quot;&gt;
&lt;p&gt;不论什么时候，心里要有爱，眼里要有光&lt;/p&gt;

&lt;/blockquote&gt;</summary>
    
    
    
    <category term="Diary" scheme="https://ifuxing.cool/categories/Diary/"/>
    
    
    <category term="Testing" scheme="https://ifuxing.cool/tags/Testing/"/>
    
  </entry>
  
</feed>
